<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¼¬ê¼¬ë„ˆ - ê¼¬ë¦¬ì— ê¼¬ë¦¬ë¥¼ ë¬¼ì–´ ì°¾ì€ ë„ˆ</title>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <!-- Socket.io -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff6f0f 0%, #ff8f3f 50%, #ffb347 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .floating-memory {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite ease-in-out;
            font-size: 2rem;
        }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.1; }
            50% { opacity: 0.3; }
            90% { opacity: 0.1; }
        }

        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateY(0);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 90vh;
            overflow-y: auto;
        }

        .main-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
        }

        .app-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .app-title {
            font-size: 3rem;
            background: linear-gradient(135deg, #ff6f0f, #ff8f3f, #ffb347);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            margin-bottom: 10px;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            from { filter: drop-shadow(0 0 5px rgba(255, 111, 15, 0.3)); }
            to { filter: drop-shadow(0 0 20px rgba(255, 143, 63, 0.6)); }
        }

        .app-subtitle {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .app-description {
            background: linear-gradient(135deg, rgba(255, 111, 15, 0.1), rgba(255, 179, 71, 0.1));
            border: 2px solid rgba(255, 111, 15, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
            line-height: 1.6;
        }

        .app-description::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* ìƒë‹´ ì‹¤ì¢…ì•„ë™ ë°°ë„ˆ ì¶”ê°€ */
        .consultation-banner {
            background: linear-gradient(135deg, #ff6b35, #ff8f65);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
            animation: pulse 2s infinite;
            display: none;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* ìŠ¤í… ë„¤ë¹„ê²Œì´ì…˜ */
        .step-navigation {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
            max-width: 120px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .step-item.active .step-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: scale(1.1);
        }

        .step-item.completed .step-number {
            background: #4CAF50;
            color: white;
        }

        .step-label {
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            font-weight: 500;
        }

        .step-item.active .step-label {
            color: #667eea;
            font-weight: 600;
        }

        .step-line {
            position: absolute;
            top: 20px;
            left: 60px;
            right: -60px;
            height: 2px;
            background: #e0e0e0;
            z-index: -1;
        }

        .step-item:last-child .step-line {
            display: none;
        }

        .step-item.completed .step-line {
            background: #4CAF50;
        }

        /* ì§„í–‰ë¥  í‘œì‹œ */
        .progress-container {
            margin: 20px 0;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            display: block;
        }

        .progress-bar {
            height: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ë¡œë”© ìƒíƒœ ê°œì„  */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .loading-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e0e0e0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .loading-subtext {
            font-size: 0.9rem;
            color: #666;
        }

        /* ì•Œë¦¼ ë©”ì‹œì§€ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1001;
            border-left: 4px solid #4CAF50;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-left-color: #f44336;
        }

        .notification.warning {
            border-left-color: #ff9800;
        }

        /* ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ */
        .form-input.invalid, .form-textarea.invalid {
            border-color: #f44336;
            box-shadow: 0 0 0 3px rgba(244, 67, 54, 0.1);
        }

        .form-input.valid, .form-textarea.valid {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .field-error {
            color: #f44336;
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
        }

        .field-error.show {
            display: block;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ ê°œì„  */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        .slide-up {
            animation: slideUp 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .login-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .category-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-card {
            background: white;
            border: 3px solid transparent;
            border-radius: 20px;
            padding: 20px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .category-card:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #667eea;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
        }

        .category-card:hover::before {
            opacity: 0.1;
        }

        .category-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            transform: scale(1.02);
        }

        .category-icon {
            font-size: 2rem;
            position: relative;
            z-index: 1;
        }

        .category-title {
            font-weight: 600;
            color: #333;
            position: relative;
            z-index: 1;
            font-size: 1.1rem;
        }

        .question-section {
            display: none;
            margin-top: 30px;
        }

        .question-section.active {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        .question-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .question-card.active {
            border-color: #667eea;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
        }

        .question-subtitle {
            font-size: 1rem;
            background: linear-gradient(135deg, #ffeb3b, #ffc107);
            color: #b8860b;
            margin-bottom: 20px;
            font-weight: 600;
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid #ffc107;
            text-align: center;
            box-shadow: 0 3px 10px rgba(255, 193, 7, 0.3);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 15px;
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-weight: 500;
        }

        .tag:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }

        .tag.selected {
            background: linear-gradient(135deg, #ff6b35, #ff8f65);
            transform: scale(1.05);
        }

        .additional-input {
            margin-top: 10px;
        }

        .additional-input input {
            width: 100%;
            padding: 12px 15px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }

        .additional-input input:focus {
            border-color: #667eea;
            border-style: solid;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            margin: 5px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-secondary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.4);
        }

        .review-section {
            display: none;
            margin-top: 30px;
        }

        .review-section.active {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        .review-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
        }

        .review-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .review-question {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .review-answer {
            color: #666;
            font-size: 0.9rem;
            background: white;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .edit-btn {
            background: linear-gradient(135deg, #ffc107, #ff8f00);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-top: 8px;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(255, 193, 7, 0.3);
        }

        .matching-results {
            display: none;
            margin-top: 30px;
        }

        .matching-results.active {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        .match-list {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .match-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            background: rgba(102, 126, 234, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .match-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .match-info {
            flex: 1;
        }

        .match-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .match-details {
            font-size: 0.9rem;
            color: #666;
        }

        .match-percentage {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .comparison-section {
            display: none;
            margin-top: 30px;
        }

        .comparison-section.active {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        .comparison-table {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .comparison-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .comparison-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .question-title {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
        }

        .answer-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .my-answer-section {
            text-align: center;
        }

        .partner-answer-section {
            text-align: center;
        }

        .answer-label {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .my-answer-label {
            color: #667eea;
        }

        .partner-answer-label {
            color: #ff6b35;
        }

        .answer-content {
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 500;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.4;
        }

        .my-answer {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.05));
            border: 2px solid rgba(102, 126, 234, 0.2);
            color: #333;
        }

        .partner-answer {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 107, 53, 0.05));
            border: 2px solid rgba(255, 107, 53, 0.2);
            color: #333;
        }

        .similar-match {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
            border: 2px solid rgba(76, 175, 80, 0.3);
        }

        .exact-match {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05));
            border: 2px solid rgba(33, 150, 243, 0.3);
        }

        .match-indicator {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 8px;
        }

        .similar-indicator {
            background: #4CAF50;
            color: white;
        }

        .exact-indicator {
            background: #2196F3;
            color: white;
        }

        .chat-room {
            display: none;
        }

        .chat-room.active {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            text-align: center;
            font-weight: 600;
        }

        .chat-messages {
            background: white;
            padding: 20px;
            min-height: 300px;
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #667eea;
            border-top: none;
        }

        .chat-input-area {
            background: white;
            padding: 20px;
            border: 2px solid #667eea;
            border-top: none;
            border-radius: 0 0 15px 15px;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
        }

        .chat-input:focus {
            border-color: #667eea;
        }

        .send-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 18px;
            max-width: 70%;
            line-height: 1.4;
        }

        .message.sent {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-left: auto;
            text-align: right;
        }

        .message.received {
            background: #f1f3f4;
            color: #333;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .sparkle {
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        /* ì¡°ê±´ë¶€ ì§ˆë¬¸ ìˆ¨ê¹€ */
        .conditional-question {
            display: none;
        }

        .conditional-question.show {
            display: block;
            animation: slideUp 0.6s ease-out;
        }

        /* ê°œì¸ì •ë³´ ë³´í˜¸ ì•ˆë‚´ ìŠ¤íƒ€ì¼ */
        .privacy-notice {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 20px 25px;
            border-radius: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
            border: 2px solid rgba(76, 175, 80, 0.2);
            line-height: 1.5;
            animation: fadeInUp 0.8s ease-out;
        }

        .privacy-notice::before {
            content: 'ğŸ”’';
            font-size: 1.5rem;
            margin-right: 10px;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ìŠ¤íƒ€ì¼ */
        .kakao-login-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .login-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .login-subtitle {
            font-size: 1rem;
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .kakao-login-btn {
            background: #FEE500;
            color: #000;
            border: none;
            border-radius: 12px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(254, 229, 0, 0.3);
        }

        .kakao-login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(254, 229, 0, 0.4);
        }

        .kakao-icon {
            width: 20px;
            height: 20px;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDNDNy4wMyAzIDMgNi4zNCAzIDEwLjVDMyAxMy4zIDUuNSAxNS42IDkgMTYuNUwxMSAyMUwxMyAxNi41QzE2LjUgMTUuNiAxOSAxMy4zIDE5IDEwLjVDMTkgNi4zNCAxNC45NyAzIDEyIDNaIiBmaWxsPSIjMDAwIi8+Cjwvc3ZnPgo=') no-repeat center;
            background-size: contain;
        }

        .user-info-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: none;
        }

        .user-profile {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #667eea;
        }

        .user-details h3 {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 5px;
        }

        .user-details p {
            color: #666;
            font-size: 0.9rem;
        }

        .logout-btn {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #d32f2f;
        }

        /* ì•ˆë‚´ ë¬¸êµ¬ ìŠ¤íƒ€ì¼ */
        .question-notice {
            background: rgba(255, 111, 15, 0.1);
            border: 1px solid rgba(255, 111, 15, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            margin-top: 8px;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #d45500;
            line-height: 1.4;
        }

        /* í˜„ì¬ ì¹´í…Œê³ ë¦¬ í‘œì‹œ ë°” */
        .current-category-bar {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            animation: slideDown 0.5s ease-out;
        }

        .category-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-label {
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .category-label::before {
            content: 'ğŸ“‚';
            margin-right: 10px;
            font-size: 1.3rem;
        }

        .exit-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 8px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .exit-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
                align-items: flex-start;
                padding-top: 20px;
            }

            .main-card {
                padding: 20px;
                margin: 0;
                max-height: none;
                min-height: auto;
                width: 100%;
                max-width: 100%;
            }
            
            .app-title {
                font-size: 2rem;
                margin-bottom: 8px;
            }

            .answer-comparison {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .comparison-item {
                padding: 15px;
            }

            .question-title {
                font-size: 1rem;
                padding: 10px 15px;
            }

            .answer-content {
                padding: 12px 15px;
                min-height: 45px;
                font-size: 0.9rem;
            }

            .step-navigation {
                padding: 15px 10px;
            }

            .step-item {
                max-width: 80px;
            }

            .step-number {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }

            .step-label {
                font-size: 0.7rem;
            }

            .step-line {
                top: 15px;
                left: 40px;
                right: -40px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation" id="bgAnimation"></div>
    
    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText">ë§¤ì¹­ì„ ì‹œì‘í•˜ê³  ìˆìŠµë‹ˆë‹¤...</div>
            <div class="loading-subtext" id="loadingSubtext">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</div>
        </div>
    </div>

    <!-- ì•Œë¦¼ ë©”ì‹œì§€ -->
    <div class="notification" id="notification">
        <div id="notificationText">ì•Œë¦¼ ë©”ì‹œì§€</div>
    </div>

    <div class="app-container">
        <div class="main-card">
            <div class="app-header">
                <h1 class="app-title sparkle">ğŸ”— ê¼¬ê¼¬ë„ˆ</h1>
                <p class="app-subtitle">ê¼¬ë¦¬ì— ê¼¬ë¦¬ë¥¼ ë¬¼ì–´ ì°¾ì€ ë„ˆ</p>
                <div class="app-description">
                    <strong>ê¼¬ê¼¬ë„ˆëŠ” ë£° ë°©ì‹ìœ¼ë¡œ ë‹¹ì‹ ì˜ ê¸°ì–µì„ ë”ë“¬ì–´ì„œ<br>
                    ê·¸ë¦¬ìš´ ì‚¬ëŒì„ ì°¾ëŠ” ë° ë„ì›€ì„ ë“œë¦½ë‹ˆë‹¤.</strong><br><br>
                    ì´ë¦„, ì—°ë½ì²˜, ì‚¬ì§„ ë“± ëª…í™•í•œ ì •ë³´ê°€ ì—†ì–´ë„<br>
                    ì–´ë ´í’‹í•œ ê¸°ì–µë§Œìœ¼ë¡œ ì¸ì—°ì„ ì°¾ì„ ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ë°©ì‹ì˜ í”Œë«í¼ì…ë‹ˆë‹¤.
                </div>
            </div>

            <!-- ì‹¤ì¢…ì•„ë™ ë°°ë„ˆ -->
            <div class="consultation-banner" id="consultationBanner" onclick="goBackToCategory()" style="cursor: pointer;">
                ğŸ¥ ì‹¤ì¢…ì•„ë™
            </div>

            <!-- ìŠ¤í… ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="step-navigation" id="stepNavigation" style="display: none;">
                <div class="step-item active" id="step1">
                    <div class="step-number">1</div>
                    <div class="step-label">ì¹´í…Œê³ ë¦¬</div>
                    <div class="step-line"></div>
                </div>
                <div class="step-item" id="step2">
                    <div class="step-number">2</div>
                    <div class="step-label">ì •ë³´ì…ë ¥</div>
                    <div class="step-line"></div>
                </div>
                <div class="step-item" id="step3">
                    <div class="step-number">3</div>
                    <div class="step-label">ê²€í† </div>
                    <div class="step-line"></div>
                </div>
                <div class="step-item" id="step4">
                    <div class="step-number">4</div>
                    <div class="step-label">ë§¤ì¹­</div>
                    <div class="step-line"></div>
                </div>
                <div class="step-item" id="step5">
                    <div class="step-number">5</div>
                    <div class="step-label">ì—°ê²°</div>
                </div>
            </div>

            <div class="progress-container" id="progressContainer" style="display: none;">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <!-- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì„¹ì…˜ -->
            <div class="kakao-login-section" id="kakaoLoginSection">
                <h2 class="login-title">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                <p class="login-subtitle">
                    ê¼¬ê¼¬ë„ˆ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹œë ¤ë©´<br>
                    ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”
                </p>
                <button class="kakao-login-btn" onclick="loginWithKakao()">
                    <div class="kakao-icon"></div>
                    ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸
                </button>
            </div>

            <!-- ì‚¬ìš©ì ì •ë³´ ì„¹ì…˜ -->
            <div class="user-info-section" id="userInfoSection">
                <div class="user-profile">
                    <img class="user-avatar" id="userAvatar" src="" alt="í”„ë¡œí•„">
                    <div class="user-details">
                        <h3 id="userName">ì‚¬ìš©ìëª…</h3>
                        <p id="userEmail">ì´ë©”ì¼</p>
                    </div>
                </div>
                <button class="logout-btn" onclick="logoutKakao()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>

            <div class="login-section" id="loginSection" style="display: none;">
                <div class="privacy-notice">
                    ê¼¬ê¼¬ë„ˆëŠ” ì‹¤ëª…ê³¼ ë‹¹ì‹ ì˜ ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ì„œ ì£¼ë¯¼ë²ˆí˜¸ë¥¼ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ ì§ˆë¬¸í•˜ëŠ” ê¸°ì–µ ê¸°ë°˜ ë‚´ìš©ì„ ì„±ì‹¤í•˜ê²Œ ì…ë ¥í•´ ì£¼ì„¸ìš”.
                </div>
                <button class="btn btn-primary" onclick="startApp()">
                    ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                </button>
                <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">ë² íƒ€ ë²„ì „ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì‹œì‘í•˜ì„¸ìš”</p>
            </div>

            <div class="category-section hidden" id="mainCategorySection">
                <h3 class="section-title">ì•ˆë…•í•˜ì„¸ìš”. ì°¾ê³  ì‹¶ì€ ì‚¬ëŒì„ ì„ íƒí•´ì£¼ì„¸ìš”.</h3>
                <div class="category-grid">
                    <div class="category-card" onclick="selectMainCategory('missing')">
                        <span class="category-icon">ğŸ‘¶</span>
                        <div class="category-title">ì‹¤ì¢…ì•„ë™(ê°€ì¡±)</div>
                    </div>
                    
                    <div class="category-card" onclick="selectMainCategory('separated')">
                        <span class="category-icon">ğŸ‘´</span>
                        <div class="category-title">ì´ì‚°ê°€ì¡±</div>
                    </div>
                    <div class="category-card" onclick="selectMainCategory('friends')">
                        <span class="category-icon">ğŸ‘¥</span>
                        <div class="category-title">ê·¸ë¦¬ìš´ì¹œêµ¬</div>
                    </div>
                </div>
            </div>

            <!-- í˜„ì¬ ì¹´í…Œê³ ë¦¬ í‘œì‹œ ë°” -->
            <div class="current-category-bar" id="currentCategoryBar" style="display: none;">
                <div class="category-info">
                    <span class="category-label" id="currentCategoryLabel">ì‹¤ì¢…ì•„ë™</span>
                    <button class="exit-btn" onclick="goBackToCategory()">ë‚˜ê°€ê¸°</button>
                </div>
            </div>

            <div class="question-section" id="questionSection">
                <div class="question-card active">
                    <p class="question-subtitle">ì‚¬ë¡€ ì¤‘ì—ì„œ ì—¬ëŸ¬ê°œ ì„ íƒí•´ë„ ë˜ë©° í•´ë‹¹ ì‚¬í•­ì´ ì—†ìœ¼ë©´ ë¹ˆì¹¸ì— ì…ë ¥í•´ ì£¼ì„¸ìš”. ì…ë ¥ ìë£Œê°€ ë§ì„ ê²½ìš° ë°˜ë“œì‹œ ì‰¼í‘œë¡œ êµ¬ë¶„í•´ ì£¼ì„¸ìš”.</p>
                    
                    <div id="questionsContainer">
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="reviewAnswers()" id="reviewBtn">ì…ë ¥ ë‚´ìš© í™•ì¸ ë° ìˆ˜ì •</button>
                        <button class="btn btn-primary" onclick="startMatching()" id="startMatchingBtn">ë§¤ì¹­ ì‹œì‘í•˜ê¸°</button>
                    </div>
                </div>
            </div>

            <div class="review-section" id="reviewSection">
                <div class="review-card">
                    <h3 style="margin-bottom: 20px; color: #333; text-align: center;">ì…ë ¥í•˜ì‹  ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”</h3>
                    <div id="reviewContent">
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="proceedToMatching()">ìˆ˜ì • ì™„ë£Œ - ë§¤ì¹­í•˜ê¸°</button>
                        <button class="btn btn-secondary" onclick="goBackToQuestions()">ë” ìˆ˜ì •í•˜ê¸°</button>
                    </div>
                </div>
            </div>

            <div class="matching-results" id="matchingResults">
                <div class="match-list">
                    <h3 style="margin-bottom: 20px; color: #333;">ë§¤ì¹­ ê²°ê³¼</h3>
                    <div id="matchList">
                    </div>
                </div>
            </div>

            <div class="comparison-section" id="comparisonSection">
                <div class="comparison-table">
                    <h3 style="margin-bottom: 25px; color: #333; text-align: center; font-size: 1.3rem;">ìƒì„¸ ë¹„êµ ì •ë³´</h3>
                    <div id="comparisonContent">
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-primary" onclick="proceedToChat()">ì±„íŒ…ë°© ì…ì¥í•˜ê¸°</button>
                        <button class="btn btn-secondary" onclick="goBackToMatching()">ë‹¤ë¥¸ ë§¤ì¹­ ë³´ê¸°</button>
                    </div>
                </div>
            </div>

            <div class="chat-room" id="chatRoom">
                <div class="chat-header">
                    <h3 id="chatPartnerName">ê¹€â—‹â—‹ë‹˜ê³¼ì˜ ëŒ€í™”</h3>
                    <div class="chat-status">
                        <span class="online-indicator"></span>
                        ì‹¤ì‹œê°„ ì±„íŒ…
                    </div>
                </div>
                <div class="chat-messages" id="chatMessages">
                </div>
                <div class="chat-input-area">
                    <input type="text" class="chat-input" id="chatInput" placeholder="ì‹¤ì‹œê°„ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="if(event.key==='Enter') sendMessage()">
                    <button class="send-btn" onclick="sendMessage()">ì „ì†¡</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentStep = 'login';
        let selectedCategory = '';
        let selectedSubCategory = '';
        let answers = {};
        let currentPartner = null;
        let currentUser = null;
        let socket = null;
        let currentChatRoom = null;

        // ì´ì‚°ê°€ì¡± ì§ˆë¬¸ ë°ì´í„° (25ê°œ)
        const separatedFamilyQuestions = [
            {
                id: 'familyClan',
                question: 'ë³¸ê´€',
                type: 'text',
                placeholder: 'ì˜ˆ: ì „ì£¼ì´ì”¨, ê¹€í•´ê¹€ì”¨',
                notice: 'ì „ì£¼ì´ì”¨ ì‹ìœ¼ë¡œ ì¨ì£¼ì„¸ìš”.',
                required: true
            },
            {
                id: 'hometown',
                question: 'ë‚˜ì˜ ê³ í–¥',
                type: 'text',
                placeholder: 'ì˜ˆ: í•¨ê²½ë‚¨ë„ í¥ë‚¨ì‹œ',
                required: true
            },
            {
                id: 'myPhysicalFeatures',
                question: 'ë‚˜ì˜ ì‹ ì²´íŠ¹ì§•',
                type: 'textarea',
                placeholder: 'í‚¤, ì²´í˜•, ì , í‰í„° ë“± ì‹ ì²´ì  íŠ¹ì§•ì„ ìì„¸íˆ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'familyPhysicalFeatures',
                question: 'ë‹¤ë¥¸ ê°€ì¡±ì˜ ì‹ ì²´íŠ¹ì§•',
                type: 'textarea',
                placeholder: 'ë¶€ëª¨ë‹˜, í˜•ì œìë§¤ì˜ ì‹ ì²´ì  íŠ¹ì§•ì„ ê¸°ì–µë‚˜ëŠ” ëŒ€ë¡œ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'relativeNames',
                question: 'ì™¸ê°€ ì¹œê°€ ì¤‘ ê¸°ì–µë‚˜ëŠ” ì´ë¦„ ì „ë¶€',
                type: 'textarea',
                placeholder: 'í• ì•„ë²„ì§€, í• ë¨¸ë‹ˆ, ì‚¼ì´Œ, ì´ëª¨ ë“± ì¹œì²™ë“¤ì˜ ì´ë¦„ì„ ëª¨ë‘ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'relativeLocations',
                question: 'ì™¸ê°€ ì¹œê°€ë“¤ ì‚´ë˜ ë™ë„¤',
                type: 'textarea',
                placeholder: 'ì¹œì²™ë“¤ì´ ì‚´ë˜ ì§€ì—­ì´ë‚˜ ë™ë„¤ë¥¼ ê¸°ì–µë‚˜ëŠ” ëŒ€ë¡œ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'separationYear',
                question: 'í—¤ì–´ì§„ ë…„ë„',
                type: 'text',
                placeholder: 'ì˜ˆ: 1950ë…„, 1951ë…„',
                required: true
            },
            {
                id: 'separationAge',
                question: 'í—¤ì–´ì§ˆ ë•Œ ë‚˜ì´',
                type: 'text',
                placeholder: 'ì˜ˆ: 15ì‚´, 20ì„¸',
                notice: 'ë‚˜ì´ë‚˜ íƒœì–´ë‚œ í•´ëŠ” ì •í™•í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ì•ë’¤ 1ë…„ì„ í¬í•¨í•´ì„œ 3ë…„ ë²”ìœ„ë¡œ ë§¤ì¹­ ë“¤ì–´ê°‘ë‹ˆë‹¤.',
                required: true
            },
            {
                id: 'separationReason',
                question: 'í—¤ì–´ì§€ê²Œ ëœ ì´ìœ ',
                type: 'textarea',
                placeholder: 'ì „ìŸ, í”¼ë‚œ, ì›”ë‚¨ ë“± í—¤ì–´ì§€ê²Œ ëœ êµ¬ì²´ì ì¸ ìƒí™©ì„ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'separationPlace',
                question: 'í—¤ì–´ì§„ ì¥ì†Œ',
                type: 'text',
                placeholder: 'ì˜ˆ: ì„œìš¸ì—­, ë¶€ì‚°í•­, ì¸ì²œí•­'
            },
            {
                id: 'parentsJob',
                question: 'ë¶€ëª¨ ì§ì—…',
                type: 'text',
                placeholder: 'ì˜ˆ: ì•„ë²„ì§€-ë†ì—…, ì–´ë¨¸ë‹ˆ-ì£¼ë¶€'
            },
            {
                id: 'familyMotto',
                question: 'ê°€í›ˆ',
                type: 'text',
                placeholder: 'ì§‘ì•ˆì˜ ê°€í›ˆì´ë‚˜ ëŒ€ëŒ€ë¡œ ë‚´ë ¤ì˜¤ëŠ” ë§ì”€'
            },
            {
                id: 'familyIncidents',
                question: 'êµí†µì‚¬ê³  ë„ë‘‘ ë“± ì§‘ì•ˆì— í°ì¼ ê¸°ì–µë‚˜ëŠ” ê²ƒ',
                type: 'textarea',
                placeholder: 'ì§‘ì•ˆì— ì¼ì–´ë‚¬ë˜ í° ì‚¬ê±´ì´ë‚˜ ì‚¬ê³ ë¥¼ ê¸°ì–µë‚˜ëŠ” ëŒ€ë¡œ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'hospitalName',
                question: 'ì˜ ê°€ë˜ ë³‘ì› ì´ë¦„',
                type: 'text',
                placeholder: 'ì˜ˆ: ì œì¤‘ì›, ì„¸ë¸Œë€ìŠ¤ë³‘ì›'
            },
            {
                id: 'restaurantName',
                question: 'ì˜ ê°€ë˜ ì‹ë‹¹ ì´ë¦„',
                type: 'text',
                placeholder: 'ìì£¼ ê°€ë˜ ì‹ë‹¹ì´ë‚˜ ìŒì‹ì  ì´ë¦„'
            },
            {
                id: 'touristSpots',
                question: 'í•¨ê»˜ ë†€ëŸ¬ê°”ë˜ ë°”ë‹¤ ë˜ëŠ” ëª…ìŠ¹ì§€',
                type: 'text',
                placeholder: 'ì˜ˆ: í•´ìš´ëŒ€, ê¸ˆê°•ì‚°, ë°±ë‘ì‚°'
            },
            {
                id: 'deceasedRelativeIllness',
                question: 'ì¹œì²™ ì¤‘ ëŒì•„ê°€ì‹  ë¶„ì˜ ë³‘ëª…',
                type: 'text',
                placeholder: 'ì˜ˆ: í• ì•„ë²„ì§€-íë ´, ì‚¼ì´Œ-ê²°í•µ'
            },
            {
                id: 'neighborFriends',
                question: 'ë™ë„¤ì¹œêµ¬ë“¤ ì´ë¦„ê³¼ ë³„ëª… ì „ë¶€',
                type: 'textarea',
                placeholder: 'ì–´ë¦´ ë•Œ ê°™ì´ ë†€ë˜ ë™ë„¤ ì¹œêµ¬ë“¤ì˜ ì´ë¦„ê³¼ ë³„ëª…ì„ ëª¨ë‘ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'departurePeriod',
                question: 'ê³ í–¥ ë– ë‚œ ì‹œê¸°',
                type: 'tags',
                options: ['í•´ë°©ì „', 'í•´ë°©ì§í›„', '6.25 ë°œë°œ', '6.25 ì¤‘', '1.4í›„í‡´', 'í”¼ë‚œì‹œê¸°', 'ì •ì „í˜‘ì •í›„', '1960ë…„ëŒ€', '1970ë…„ëŒ€', '1980ë…„ëŒ€', '1990ë…„ëŒ€', '2000ë…„ëŒ€', '2010ë…„ëŒ€', '2020ë…„ëŒ€', 'ê¸°íƒ€ì‹œê¸°']
            },
            {
                id: 'northKoreaLocation',
                question: 'ë¶í•œ ê³ í–¥ êµ¬ì²´ì  ì§€ëª…',
                type: 'text',
                placeholder: 'ì˜ˆ: í•¨ê²½ë‚¨ë„ í¥ë‚¨ì‹œ ì†¡í‰ë™',
                required: true
            },
            {
                id: 'leftBehindFamily',
                question: 'ë¶í•œì— ë‚¨ì€ ê°€ì¡±/ì¹œì²™',
                type: 'tags',
                options: ['ë¶€ëª¨ë‹˜', 'í˜•ì œ', 'ìë§¤', 'í• ì•„ë²„ì§€', 'í• ë¨¸ë‹ˆ', 'ì™¸í• ì•„ë²„ì§€', 'ì™¸í• ë¨¸ë‹ˆ', 'ì‚¼ì´Œ', 'ì´ëª¨', 'ê³ ëª¨', 'ì™¸ì‚¼ì´Œ', 'ì‚¬ì´Œ', 'ì¡°ì¹´', 'ìë…€', 'ë°°ìš°ì']
            },
            {
                id: 'firstSettlement',
                question: 'ë‚¨í•œ ì²« ì •ì°©ì§€',
                type: 'text',
                placeholder: 'ì˜ˆ: ë¶€ì‚°ì‹œ ì˜ë„êµ¬, ì„œìš¸ì‹œ ìš©ì‚°êµ¬',
                required: true
            },
            {
                id: 'refugeeExperience',
                question: 'í”¼ë‚œë¯¼ìœ¼ë¡œì„œì˜ ê²½í—˜',
                type: 'textarea',
                placeholder: 'í”¼ë‚œ ê³¼ì •ì—ì„œ ê²ªì—ˆë˜ ì¼ë“¤, ì •ì°© ê³¼ì •ì˜ ì–´ë ¤ì›€ ë“±ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'northKoreaMemories',
                question: 'ë¶í•œì—ì„œì˜ ê¸°ì–µ',
                type: 'textarea',
                placeholder: 'ë¶í•œì—ì„œ ì‚´ì•˜ì„ ë•Œì˜ ìƒí™œ, í’ê²½, ì‚¬ëŒë“¤ì— ëŒ€í•œ ê¸°ì–µì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'familyTraditions',
                question: 'ì§‘ì•ˆ ì „í†µ/ê´€ìŠµ',
                type: 'textarea',
                placeholder: 'ì§‘ì•ˆì—ì„œ ì§€ì¼œì˜¤ë˜ ì „í†µì´ë‚˜ ê´€ìŠµ, ì œì‚¬ ë°©ë²• ë“±ì„ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'searchAttempts',
                question: 'ì´ì‚°ê°€ì¡± ì°¾ê¸° ì‹œë„ ë°©ë²•',
                type: 'tags',
                options: ['ì ì‹­ìì‚¬', 'KBSì´ì‚°ê°€ì¡±ì°¾ê¸°', 'MBCì´ì‚°ê°€ì¡±ì°¾ê¸°', 'ì‹ ë¬¸ê´‘ê³ ', 'ë°©ì†¡ì¶œì—°', 'ì¸í„°ë„·ê²€ìƒ‰', 'ì •ë¶€ê¸°ê´€', 'êµíšŒ', 'ì ˆ', 'í–¥ìš°íšŒ', 'ë™ì°½íšŒ', 'ì¹œì²™ì†Œê°œ', 'ì§€ì¸ì†Œê°œ', 'ê°œì¸íƒì •', 'ê¸°íƒ€ë°©ë²•']
            }
        ];

        // ì‹¤ì¢…ì•„ë™ ì§ˆë¬¸ ë°ì´í„° (ê¸°ì¡´ 29ê°œ ì§ˆë¬¸)
        const missingChildQuestions = [
            {
                id: 'targetRelation',
                question: 'ë‹¹ì‹ ì´ ì°¾ê³ ìí•˜ëŠ” ìƒëŒ€ë°©ì€ ëˆ„êµ¬ì¸ê°€ìš”?',
                type: 'tags',
                options: ['ì•„ë“¤', 'ë”¸', 'ì¡°ì¹´', 'ë¶€ëª¨ë‹˜', 'í˜•ì œ', 'ìë§¤', 'í• ì•„ë²„ì§€', 'í• ë¨¸ë‹ˆ', 'ì™¸í• ì•„ë²„ì§€', 'ì™¸í• ë¨¸ë‹ˆ', 'ì‚¼ì´Œ', 'ì´ëª¨', 'ê³ ëª¨', 'ì™¸ì‚¼ì´Œ', 'ê¸°íƒ€ê°€ì¡±'],
                required: true
            },
            {
                id: 'separationAge',
                question: 'ë‹¹ì‹ ì´ ê°€ì¡±ê³¼ í—¤ì–´ì§„ ë•Œê°€ ëª‡ì‚´ ë•Œì¸ê°€ìš”?',
                type: 'text',
                placeholder: 'ì˜ˆ: 5ì‚´, 7ì„¸',
                required: true,
                notice: 'ë‚˜ì´ë‚˜ íƒœì–´ë‚œ í•´ëŠ” ì •í™•í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ì•ë’¤ 1ë…„ì„ í¬í•¨í•´ì„œ 3ë…„ ë²”ìœ„ë¡œ ë§¤ì¹­ ë“¤ì–´ê°‘ë‹ˆë‹¤.'
            },
            {
                id: 'houseType',
                question: 'ì‚´ë˜ ì§‘ì˜ í˜•íƒœëŠ”?',
                type: 'tags',
                options: ['í•œì˜¥', 'ì–‘ì˜¥', 'ë‹¤ì„¸ëŒ€', 'ì—°ë¦½', 'ì•„íŒŒíŠ¸', 'ë‹¨ë…ì£¼íƒ', 'ë¹Œë¼', 'ìƒê°€ì£¼íƒ', 'ì „ì›ì£¼íƒ']
            },
            {
                id: 'doorColor',
                question: 'ì§‘ì˜ ëŒ€ë¬¸ ìƒ‰ê¹”ì€?',
                type: 'tags',
                options: ['íŒŒë€ìƒ‰', 'ì´ˆë¡ìƒ‰', 'ê°ˆìƒ‰', 'íšŒìƒ‰', 'ë¹¨ê°„ìƒ‰', 'í°ìƒ‰', 'ê²€ì€ìƒ‰', 'ë…¸ë€ìƒ‰', 'ë¶„í™ìƒ‰', 'ë³´ë¼ìƒ‰', 'ì£¼í™©ìƒ‰', 'ë‚˜ë¬´ìƒ‰']
            },
            {
                id: 'floorLevel',
                question: 'ëª‡ì¸µì— ì‚´ì•˜ëŠ”ì§€?',
                type: 'text',
                placeholder: 'ì˜ˆ: 1ì¸µ, 2ì¸µ, 3ì¸µ'
            },
            {
                id: 'doorMaterial',
                question: 'ì§‘ëŒ€ë¬¸ì´ ë‚˜ë¬´ì¸ì§€ ì² ì œë¬¸ì¸ì§€?',
                type: 'tags',
                options: ['ë‚˜ë¬´', 'ì² ì œë¬¸', 'ì•Œë£¨ë¯¸ëŠ„', 'ìœ ë¦¬ë¬¸', 'ê¸°íƒ€ì¬ì§ˆ']
            },
            {
                id: 'frontStairs',
                question: 'ì§‘ ì•ì— ê³„ë‹¨ì´ ìˆì—ˆëŠ”ì§€?',
                type: 'text',
                placeholder: 'ì˜ˆ: 3ê°œ ê³„ë‹¨ ìˆìŒ, ê³„ë‹¨ ì—†ìŒ'
            },
            {
                id: 'nearbyFacilities1',
                question: 'ì§‘ ê·¼ì²˜ì— ìˆë˜ ì‹œì„¤ë“¤ (ìš°ë¬¼, ë†€ì´í„°, ê³µì› ë“±)',
                type: 'tags',
                options: ['ìš°ë¬¼', 'ë†€ì´í„°', 'ê³µì›', 'ì—°ëª»', 'ì‹œì¥', 'ìƒì ', 'í•™êµ', 'ë³‘ì›', 'êµíšŒ', 'ì ˆ', 'ë§ˆì„íšŒê´€', 'ê²½ì°°ì„œ', 'ì†Œë°©ì„œ']
            },
            {
                id: 'nearbyTransport',
                question: 'ì§‘ ê·¼ì²˜ êµí†µì‹œì„¤ (ì§€í•˜ì² , ê¸°ì°¨ì—­, ë²„ìŠ¤ì •ë¥˜ì†Œ)',
                type: 'tags',
                options: ['ì§€í•˜ì² ', 'ê¸°ì°¨ì—­', 'ë²„ìŠ¤ì •ë¥˜ì†Œ', 'íƒì‹œì •ë¥˜ì¥', 'ê³ ì†ë„ë¡œ', 'êµ­ë„', 'í°ê¸¸', 'ì‘ì€ê¸¸']
            },
            {
                id: 'religiousItems',
                question: 'ì§‘ì— ì‹­ìê°€ ë˜ëŠ” ë¶ˆêµ ë¬¼ê±´ì´ ìˆì—ˆë‚˜ìš”?',
                type: 'tags',
                options: ['ì‹­ìê°€', 'ë¶ˆìƒ', 'ì„±ê²½', 'ë¶ˆê²½', 'ê¸°ë„ì‹¤', 'ì œë‹¨', 'ì¢…êµë¬¼í’ˆì—†ìŒ']
            },
            {
                id: 'yardItems',
                question: 'ë§ˆë‹¹ì— ìˆë˜ ê²ƒë“¤ì€?',
                type: 'tags',
                options: ['ì¥ë…ëŒ€', 'ìš°ë¬¼', 'ë‚˜ë¬´', 'í™”ë‹¨', 'í…ƒë°­', 'ê°•ì•„ì§€ì§‘', 'ë‹­ì¥', 'ì°½ê³ ', 'í‰ìƒ', 'ê·¸ë„¤', 'ë¹¨ë˜í„°', 'í™”ì¥ì‹¤']
            },
            {
                id: 'farmingCrops',
                question: 'í…ƒë°­ì—ì„œ ë†ì‘ë¬¼ì„ í‚¤ì› ëŠ”ì§€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ê³ ì¶”, ë°°ì¶”, ìƒì¶” ë“±'
            },
            {
                id: 'relativeHouse',
                question: 'ìì£¼ ë†€ëŸ¬ê°€ë˜ ì¹œì²™ì§‘ì€?',
                type: 'tags',
                options: ['í• ì•„ë²„ì§€ëŒ', 'ì™¸ê°€ëŒ', 'ì‚¼ì´Œ', 'ê³ ëª¨', 'ì´ëª¨', 'ì™¸ì‚¼ì´Œ', 'í°ì•„ë²„ì§€', 'ì‘ì€ì•„ë²„ì§€', 'ì¹œì²™ì—†ìŒ']
            },
            {
                id: 'relativeHouseFeatures',
                question: 'ì¹œì²™ì§‘ì˜ íŠ¹ì§•ì€?',
                type: 'tags',
                options: ['ë§ˆë‹¹', 'ê·¸ë„¤', 'ë™ë¬¼', 'ì—°ëª»', 'ê³¼ìˆ˜ì›', 'ë°­', 'ì‚°', 'ê°•', 'ë°”ë‹¤ê·¼ì²˜', 'ì‹œê³¨', 'ë„ì‹œ']
            },
            {
                id: 'desiredToys',
                question: 'ì‚¬ë‹¬ë¼ê³  ì¡¸ëë˜(ë°›ì•˜ë˜) ì¥ë‚œê°ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ìì „ê±°, ì¸í˜•, ë¡œë´‡, ê³µ'
            },
            {
                id: 'christmasGifts',
                question: 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë•Œ ì¤€(ë°›ì€) ì„ ë¬¼ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ë¹¨ê°„ìƒ‰ ìì „ê±°, ê³°ì¸í˜•, ê²Œì„ê¸°'
            },
            {
                id: 'memorableGifts',
                question: 'ê¸°íƒ€ ê¸°ì–µì— ë‚¨ëŠ” ì„ ë¬¼ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ìƒì¼ì„ ë¬¼, ëª…ì ˆì„ ë¬¼ ë“±'
            },
            {
                id: 'memorableTrips',
                question: 'ê¸°ì–µì— ë‚¨ì€ ì—¬í–‰ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ë°”ë‹·ê°€, í• ë¨¸ë‹ˆì§‘, ìœ ì›ì§€, ì‚°'
            },
            {
                id: 'scoldingMemory',
                question: 'í¬ê²Œ í˜¼ë‚œ(ì•¼ë‹¨ì¹œ) ê¸°ì–µì€?',
                type: 'textarea',
                placeholder: 'ë¬´ì—‡ ë•Œë¬¸ì— í˜¼ë‚¬ëŠ”ì§€, ì–´ë–»ê²Œ í˜¼ë‚¬ëŠ”ì§€'
            },
            {
                id: 'praiseMemory',
                question: 'í¬ê²Œ ì¹­ì°¬í•œ(ë°›ì€) ê¸°ì–µì€?',
                type: 'textarea',
                placeholder: 'ë¬´ì—‡ ë•Œë¬¸ì— ì¹­ì°¬ë°›ì•˜ëŠ”ì§€'
            },
            {
                id: 'familyPhysicalFeatures',
                question: 'ë¶€ëª¨ í˜•ì œë“¤ì˜ ì‹ ì²´ íŠ¹ì§• (ì , ë¬¸ì‹ , ë¶ˆêµ¬)',
                type: 'textarea',
                placeholder: 'ì˜ˆ: ì•„ë²„ì§€ ì™¼ìª½ ì–´ê¹¨ì— ì , ì–´ë¨¸ë‹ˆ ë‹¤ë¦¬ ì ˆëš'
            },
            {
                id: 'familyIllness',
                question: 'ê°€ì¡± ì¤‘ ì•„íŒ ë˜ ë¶„ê³¼ ë³‘ëª…ì€?',
                type: 'textarea',
                placeholder: 'ì˜ˆ: í• ë¨¸ë‹ˆê°€ ë‹¹ë‡¨ë³‘ìœ¼ë¡œ ì•„í”„ì…¨ìŒ'
            },
            {
                id: 'deceasedRelatives',
                question: 'ì‚¬ë§í•œ ì¹œì²™, ì´ì›ƒì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: í• ì•„ë²„ì§€, ì´ì›ƒ í• ë¨¸ë‹ˆ'
            },
            {
                id: 'parentsCooking',
                question: 'ë¶€ëª¨ë‹˜ì´ ì˜í•´ì£¼ì‹  ìŒì‹ì€?',
                type: 'tags',
                options: ['ê¹€ì¹˜ì°Œê°œ', 'ëœì¥ì°Œê°œ', 'ë¯¸ì—­êµ­', 'ë¶ˆê³ ê¸°', 'ê°ˆë¹„', 'ìƒì„ êµ¬ì´', 'ê³„ë€í›„ë¼ì´', 'ë³¶ìŒë°¥', 'êµ­ìˆ˜', 'ë§Œë‘', 'ë–¡êµ­', 'ì”ì¹˜êµ­ìˆ˜']
            },
            {
                id: 'snackFoods',
                question: 'ìì£¼ í–ˆë˜ êµ°ê²ƒì§ˆì€?',
                type: 'tags',
                options: ['ì‚¬íƒ•', 'ê³¼ì', 'ë–¡ë³¶ì´', 'ìˆœëŒ€', 'ì–´ë¬µ', 'ë¶•ì–´ë¹µ', 'í˜¸ë–¡', 'êµ°ê³ êµ¬ë§ˆ', 'êµ°ë°¤', 'ì•„ì´ìŠ¤í¬ë¦¼', 'ìŒë£Œìˆ˜', 'ê»Œ']
            },
            {
                id: 'familyDining',
                question: 'ê°€ì¡±ë“¤ê³¼ ê°™ì´ ë¨¹ì—ˆë˜ ì™¸ì‹ì€?',
                type: 'tags',
                options: ['ì§œì¥ë©´', 'ì§¬ë½•', 'ëƒ‰ë©´', 'ê°ˆë¹„', 'ë¶ˆê³ ê¸°', 'ì¹˜í‚¨', 'í”¼ì', 'í–„ë²„ê±°', 'ì¤‘êµ­ì§‘', 'í•œì •ì‹', 'ì¹¼êµ­ìˆ˜', 'ì„¤ë íƒ•']
            },
            {
                id: 'neighborFriendNames',
                question: 'ë™ë„¤ ì¹œêµ¬ ì´ë¦„ê³¼ ë³„ëª…ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ì² ìˆ˜, ì˜í¬, í˜¸ëŒì´'
            },
            {
                id: 'friendFatherJob',
                question: 'ë™ë„¤ ì¹œêµ¬ì˜ ì•„ë²„ì§€ ì§ì—…ì€?',
                type: 'tags',
                options: ['ìƒì„ ê°€ê²Œ', 'êµ¬ë©ê°€ê²Œ', 'ìŠˆí¼', 'ì‹ë‹¹', 'ì´ë°œì†Œ', 'ì„¸íƒì†Œ', 'ì•½êµ­', 'ë¬¸ë°©êµ¬', 'ì •ìœ¡ì ', 'ê³¼ì¼ê°€ê²Œ', 'ë¹µì§‘', 'ì¹´í˜', 'ì² ë¬¼ì ']
            },
            {
                id: 'friendSiblings',
                question: 'ì¹œêµ¬ í˜•ì œ ë‚¨ë§¤ì˜ ì´ë¦„ê³¼ ë³„ëª…ì€?',
                type: 'text',
                placeholder: 'ì˜ˆ: ì² ìˆ˜ í˜•, ì˜í¬ ëˆ„ë‚˜'
            },
            {
                id: 'otherMemories',
                question: 'ê¸°íƒ€ ê¸°ì–µí•˜ê³  ìˆëŠ” ëª¨ë“  ê²ƒ',
                type: 'textarea',
                placeholder: 'ì‘ì€ ê¸°ì–µë“¤ì´ë¼ë„ ëª¨ë‘ ì ì–´ì£¼ì„¸ìš”. ëƒ„ìƒˆ, ì†Œë¦¬, ëŠë‚Œ, ë™ë„¤ íŠ¹ì§• ë“± ë¬´ì—‡ì´ë“ ...'
            }
        ];

        // ìƒˆë¡œìš´ ê·¸ë¦¬ìš´ì¹œêµ¬ í†µí•© ì§ˆë¬¸ ë°ì´í„° (22ê°œ)
        const friendQuestions = [
            {
                id: 'friendType',
                question: 'ì°¾ê³  ì‹¶ì€ ì¹œêµ¬ëŠ” ëˆ„êµ¬ì¸ê°€ìš”?',
                type: 'tags',
                options: ['ë™ë„¤ì¹œêµ¬', 'ìœ ì¹˜ì›', 'ì´ˆë“±í•™êµ', 'ì¤‘í•™êµ', 'ê³ ë“±í•™êµ', 'ëŒ€í•™êµ', 'ëŒ€í•™ì›', 'êµ°ëŒ€ì¹œêµ¬', 'ì§ì¥ì¹œêµ¬'],
                required: true
            },
            {
                id: 'nickname',
                question: 'ë³¸ì¸ì˜ ë³„ëª… ë˜ëŠ” ë‹‰ë„¤ì„',
                type: 'text',
                placeholder: 'ê¼¬ê¼¬ë„ˆëŠ” ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ì‹¤ëª…ìœ¼ë¡œ í•˜ì§€ ì•Šìœ¼ë©° ê¸°ì–µ ê¸°ë°˜ìœ¼ë¡œ ì¶©ë¶„íˆ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.',
                notice: 'ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ì‹¤ëª…ì´ ì•„ë‹Œ ë³„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
            },
            {
                id: 'gender',
                question: 'ì°¾ê³ ì‹¶ì€ ìƒëŒ€ë°©ëŠ” ë™ì„±ì¸ê°€ìš”, ì´ì„±ì¸ê°€ìš”?',
                type: 'tags',
                options: ['ë™ì„±', 'ì´ì„±'],
                required: true
            },
            {
                id: 'school',
                question: 'ìƒëŒ€ë°©ê³¼ ê°™ì€ í•™êµì˜€ë‚˜ìš”? ë‹¤ë¥¸ í•™êµë¼ë©´ ë‹¹ì‹ ì˜ í•™êµì™€ ìƒëŒ€ë°©ì˜ í•™êµë¥¼ ì ì–´ì£¼ì„¸ìš”.',
                type: 'text',
                placeholder: 'ì˜ˆ: ê°™ì€ í•™êµ, ë‚˜-ì„œìš¸ê³  ìƒëŒ€ë°©-ë¶€ì‚°ê³ '
            },
            {
                id: 'firstMet',
                question: 'ìƒëŒ€ë°©ì€ ì²˜ìŒ ì–´ë””ì„œ ë§Œë‚¬ë‚˜ìš”?',
                type: 'text',
                placeholder: 'ì˜ˆ: í•™êµ ìš´ë™ì¥, ë™ë„¤ ë†€ì´í„°, êµ°ë¶€ëŒ€ ìƒí™œê´€'
            },
            {
                id: 'ageWhenMet',
                question: 'ìƒëŒ€ë°©ì„ ëª‡ì‚´(ëª‡í•™ë…„) ë•Œ ë§Œë‚¬ë‚˜ìš”?',
                type: 'text',
                placeholder: 'ì˜ˆ: 15ì‚´, ê³ ë“±í•™êµ 1í•™ë…„'
            },
            {
                id: 'major',
                question: 'ëŒ€í•™êµ ì¹œêµ¬ë¼ë©´ ë‹¹ì‹ ê³¼ ìƒëŒ€ë°©ì˜ ì „ê³µê³¼ëª©ì„ ì¨ì£¼ì„¸ìš”.',
                type: 'text',
                placeholder: 'ì˜ˆ: ë‚˜-ê²½ì˜í•™ê³¼, ìƒëŒ€ë°©-ì»´í“¨í„°ê³µí•™ê³¼',
                conditional: true,
                dependsOn: 'friendType',
                showWhen: ['ëŒ€í•™êµ', 'ëŒ€í•™ì›']
            },
            {
                id: 'memorableEvent',
                question: 'ì¹œêµ¬ì™€ ê¸°ì–µì— ë‚¨ëŠ” í•´í”„ë‹',
                type: 'textarea',
                placeholder: 'í•¨ê»˜ ê²ªì—ˆë˜ ì¬ë¯¸ìˆê±°ë‚˜ ê¸°ì–µì— ë‚¨ëŠ” ì¼ë“¤ì„ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'myNeighborhood',
                question: 'ë‹¹ì‹ ì´ ì‚´ë˜ ë™ë„¤',
                type: 'text',
                placeholder: 'ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™'
            },
            {
                id: 'friendNeighborhood',
                question: 'ì¹œêµ¬ê°€ ì‚´ë˜ ë™ë„¤',
                type: 'text',
                placeholder: 'ì˜ˆ: ì„œìš¸ì‹œ ì†¡íŒŒêµ¬ ì ì‹¤ë™'
            },
            {
                id: 'myParentsJob',
                question: 'ë‹¹ì‹  ë¶€ëª¨ë‹˜ì˜ ì§ì—…',
                type: 'text',
                placeholder: 'ì˜ˆ: ì•„ë²„ì§€-íšŒì‚¬ì›, ì–´ë¨¸ë‹ˆ-ê°„í˜¸ì‚¬'
            },
            {
                id: 'friendParentsJob',
                question: 'ì¹œêµ¬ ë¶€ëª¨ë‹˜ì˜ ì§ì—…',
                type: 'text',
                placeholder: 'ì˜ˆ: ì•„ë²„ì§€-êµì‚¬, ì–´ë¨¸ë‹ˆ-ì£¼ë¶€'
            },
            {
                id: 'helpMemory',
                question: 'ì–´ë ¤ì›€ê³¼ ê³¤ê²½ì—ì„œ ì„œë¡œ ë„ì™€ì¤€ ì¼',
                type: 'textarea',
                placeholder: 'ì„œë¡œ ë„ì›€ì„ ì£¼ê³ ë°›ì•˜ë˜ ê¸°ì–µë“¤ì„ ì ì–´ì£¼ì„¸ìš”'
            },
            {
                id: 'schoolTrip',
                question: 'ê°™ì€ í•™êµë¼ë©´ ìˆ˜í•™ì—¬í–‰ ì–´ë””ë¡œ ê°”ë‚˜ìš”? (ë‹¤ë¥¸ í•™êµë¼ë©´ ë¹„ì›Œë‘ì„¸ìš”)',
                type: 'text',
                placeholder: 'ì˜ˆ: ì œì£¼ë„, ê²½ì£¼, ë¶€ì‚°',
                conditional: true,
                dependsOn: 'school',
                showWhen: 'ê°™ì€ í•™êµ'
            },
            {
                id: 'schoolTripMemory',
                question: 'ìˆ˜í•™ì—¬í–‰ì—ì„œ ì¶”ì–µì´ ë‚¨ëŠ” ì¼',
                type: 'textarea',
                placeholder: 'ìˆ˜í•™ì—¬í–‰ì—ì„œ ìˆì—ˆë˜ ê¸°ì–µì— ë‚¨ëŠ” ì¼ë“¤',
                conditional: true,
                dependsOn: 'schoolTrip'
            },
            {
                id: 'teacherNames',
                question: 'ë‹´ì„ì„ ìƒë‹˜, êµìˆ˜, í•™ê³¼ì¥ ì´ë¦„ ê¸°ì–µë‚˜ëŠ”ëŒ€ë¡œ ëª¨ë‘ ì“°ì„¸ìš”.',
                type: 'text',
                placeholder: 'ì˜ˆ: ê¹€ì² ìˆ˜ ì„ ìƒë‹˜, ë°•ì˜í¬ êµìˆ˜ë‹˜'
            },
            {
                id: 'subjectTeachers',
                question: 'ê° ê³¼ëª©ë³„ ì„ ìƒë‹˜ ì´ë¦„ê³¼ ë³„ëª…',
                type: 'textarea',
                placeholder: 'ì˜ˆ: ìˆ˜í•™-ê¹€ì„ ìƒë‹˜(ê³°ì„ ìƒ), ì˜ì–´-ì´ì„ ìƒë‹˜(ê¹Œë§ˆê·€)'
            },
            {
                id: 'gradeClass',
                question: 'í•™ë…„ê³¼ ë°˜',
                type: 'text',
                placeholder: 'ì˜ˆ: 2í•™ë…„ 3ë°˜'
            },
            {
                id: 'mySiblings',
                question: 'ë³¸ì¸ ëª‡ë‚¨ëª‡ë…€ ì¤‘ ëª‡ì§¸',
                type: 'text',
                placeholder: 'ì˜ˆ: 2ë‚¨ 1ë…€ ì¤‘ ë‘˜ì§¸'
            },
            {
                id: 'friendSiblings',
                question: 'ì¹œêµ¬ ëª‡ë‚¨ëª‡ë…€ ì¤‘ ëª‡ì§¸',
                type: 'text',
                placeholder: 'ì˜ˆ: 1ë‚¨ 2ë…€ ì¤‘ ë§‰ë‚´'
            },
            {
                id: 'scholarship',
                question: 'ì¥í•™ê¸ˆ ë°›ì€ ê²½í—˜',
                type: 'text',
                placeholder: 'ì˜ˆ: ì„±ì ìš°ìˆ˜ ì¥í•™ê¸ˆ, ê·¼ë¡œ ì¥í•™ê¸ˆ'
            },
            {
                id: 'otherDetails',
                question: 'ê¸°íƒ€ ê¸°ìˆ í•˜ê³  ì‹¶ì€ ë‚´ìš© ì“°ì„¸ìš”.',
                type: 'textarea',
                placeholder: 'ìœ„ì—ì„œ ë‹¤ë£¨ì§€ ëª»í•œ ëª¨ë“  ê¸°ì–µë“¤ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”'
            }
        ];

        // ìƒ˜í”Œ ë‹µë³€ ë°ì´í„°
        const sampleAnswers = {
            missing: {
                targetRelation: ['ë”¸'],
                separationAge: '7ì‚´',
                doorColor: ['íŒŒë€ìƒ‰'],
                houseType: ['ë‹¨ë…ì£¼íƒ'],
                frontStairs: '3ê°œ',
                nearbyFacilities1: ['ìƒì ', 'ìš°ë¬¼'],
                yardItems: ['ì¥ë…ëŒ€', 'ë‚˜ë¬´'],
                religiousItems: ['ì‹­ìê°€'],
                farmingCrops: 'ê³ ì¶”, ë°°ì¶”'
            },
            separated: {
                familyClan: 'ì „ì£¼ì´ì”¨',
                hometown: 'í•¨ê²½ë‚¨ë„ í¥ë‚¨ì‹œ',
                separationYear: '1950ë…„',
                separationAge: '20ì‚´',
                departurePeriod: ['6.25 ë°œë°œ'],
                northKoreaLocation: 'í•¨ê²½ë‚¨ë„ í¥ë‚¨ì‹œ ì†¡í‰ë™',
                firstSettlement: 'ë¶€ì‚°ì‹œ ì˜ë„êµ¬'
            },
            friends: {
                friendType: ['ê³ ë“±í•™êµ'],
                nickname: 'ì² ì´',
                gender: ['ë™ì„±'],
                school: 'ê°™ì€ í•™êµ',
                myNeighborhood: 'ì„œìš¸ì‹œ ê°•ë‚¨êµ¬',
                friendNeighborhood: 'ì„œìš¸ì‹œ ì†¡íŒŒêµ¬',
                memorableEvent: 'ì²´ìœ¡ëŒ€íšŒì—ì„œ ê°™ì´ ë‹¬ë¦¬ê¸°ë¥¼ í–ˆë˜ ê¸°ì–µì´ ë‚˜ìš”'
            }
        };

        // Firebase ë° ì†Œì¼“ ì´ˆê¸°í™” í•¨ìˆ˜ë“¤
        function initFirebase() {
            console.log('Firebase ì´ˆê¸°í™” (ë°ëª¨ ëª¨ë“œ)');
        }

        function initSocket() {
            console.log('Socket.io ì´ˆê¸°í™” (ë°ëª¨ ëª¨ë“œ)');
        }

        // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”
        function initKakao() {
            if (window.Kakao) {
                Kakao.init('YOUR_KAKAO_APP_KEY');
                console.log('ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™” ì™„ë£Œ');
                checkLoginStatus();
            }
        }

        // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('kkokko_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showUserInfo();
            } else {
                showKakaoLogin();
            }
        }

        // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
        function loginWithKakao() {
            const demoUser = {
                id: 'demo_user_' + Date.now(),
                nickname: 'ê¼¬ê¼¬ë„ˆ ì‚¬ìš©ì',
                profile_image: 'https://via.placeholder.com/60?text=ğŸ˜Š',
                email: 'demo@kkokko.com'
            };
            
            currentUser = demoUser;
            localStorage.setItem('kkokko_user', JSON.stringify(demoUser));
            showUserInfo();
            showNotification('ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤! í™˜ì˜í•©ë‹ˆë‹¤.', 'success');
        }

        // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
        function showUserInfo() {
            document.getElementById('kakaoLoginSection').style.display = 'none';
            document.getElementById('userInfoSection').style.display = 'block';
            document.getElementById('loginSection').style.display = 'block';
            
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.nickname;
                document.getElementById('userEmail').textContent = currentUser.email;
                document.getElementById('userAvatar').src = currentUser.profile_image;
            }
        }

        // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
        function showKakaoLogin() {
            document.getElementById('kakaoLoginSection').style.display = 'block';
            document.getElementById('userInfoSection').style.display = 'none';
            document.getElementById('loginSection').style.display = 'none';
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logoutKakao() {
            currentUser = null;
            localStorage.removeItem('kkokko_user');
            showKakaoLogin();
            showNotification('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            resetApp();
        }

        // ì•± ìƒíƒœ ì´ˆê¸°í™”
        function resetApp() {
            currentStep = 'login';
            selectedCategory = '';
            selectedSubCategory = '';
            answers = {};
            currentPartner = null;
            
            document.querySelectorAll('.category-section, .question-section, .review-section, .matching-results, .comparison-section, .chat-room').forEach(section => {
                section.classList.add('hidden');
                section.classList.remove('active');
            });
            
            document.getElementById('stepNavigation').style.display = 'none';
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('consultationBanner').style.display = 'none';
        }

        // UX ê°œì„  í•¨ìˆ˜ë“¤
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function showLoading(text = 'ì²˜ë¦¬ì¤‘...', subtext = 'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”') {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            const loadingSubtext = document.getElementById('loadingSubtext');
            
            loadingText.textContent = text;
            loadingSubtext.textContent = subtext;
            overlay.style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        function updateStepNavigation(currentStepNum) {
            for (let i = 1; i <= 5; i++) {
                const step = document.getElementById(`step${i}`);
                if (i < currentStepNum) {
                    step.className = 'step-item completed';
                } else if (i === currentStepNum) {
                    step.className = 'step-item active';
                } else {
                    step.className = 'step-item';
                }
            }
        }

        function updateProgress(percentage) {
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        // í•µì‹¬ í•¨ìˆ˜ë“¤
        function startApp() {
            if (!currentUser) {
                showNotification('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'warning');
                return;
            }
            
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('mainCategorySection').classList.remove('hidden');
            document.getElementById('stepNavigation').style.display = 'flex';
            document.getElementById('progressContainer').style.display = 'block';
            
            updateStepNavigation(1);
            updateProgress(20);
            currentStep = 'category';
            
            showNotification('ì‹œì‘í•©ë‹ˆë‹¤! ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'success');
        }

        function selectMainCategory(category) {
            selectedCategory = category;
            
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            event.target.closest('.category-card').classList.add('selected');
            
            if (category === 'missing') {
                selectedSubCategory = 'child';
                document.getElementById('consultationBanner').style.display = 'block';
                setTimeout(() => {
                    startQuestions();
                }, 500);
            } else if (category === 'separated') {
                // ì´ì‚°ê°€ì¡±ì€ ë°”ë¡œ ì„¤ë¬¸ìœ¼ë¡œ
                selectedSubCategory = 'family';
                setTimeout(() => {
                    startQuestions();
                }, 500);
            } else if (category === 'friends') {
                // ê·¸ë¦¬ìš´ì¹œêµ¬ëŠ” ë°”ë¡œ ì„¤ë¬¸ìœ¼ë¡œ (ì„œë¸Œì¹´í…Œê³ ë¦¬ ì œê±°ë¨)
                selectedSubCategory = 'unified';
                setTimeout(() => {
                    startQuestions();
                }, 500);
            }
            
            updateProgress(40);
            showNotification('ì¹´í…Œê³ ë¦¬ê°€ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        function startQuestions() {
            document.getElementById('mainCategorySection').classList.add('hidden');
            document.getElementById('questionSection').classList.add('active');
            document.getElementById('currentCategoryBar').style.display = 'block';
            
            // ì¹´í…Œê³ ë¦¬ ë¼ë²¨ ì—…ë°ì´íŠ¸
            updateCategoryLabel();
            
            updateStepNavigation(2);
            
            if (selectedCategory === 'missing') {
                loadMissingChildQuestions();
            } else if (selectedCategory === 'separated') {
                loadSeparatedFamilyQuestions();
            } else if (selectedCategory === 'friends') {
                loadFriendQuestions();
            }
            
            updateProgress(60);
            showNotification('ì´ì œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'success');
        }

        function updateCategoryLabel() {
            const categoryNames = {
                'missing': 'ì‹¤ì¢…ì•„ë™(ê°€ì¡±)',
                'separated': 'ì´ì‚°ê°€ì¡±', 
                'friends': 'ê·¸ë¦¬ìš´ì¹œêµ¬'
            };
            
            const label = document.getElementById('currentCategoryLabel');
            label.textContent = categoryNames[selectedCategory] || 'ì¹´í…Œê³ ë¦¬';
        }

        function loadMissingChildQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            missingChildQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'form-group fade-in';
                questionDiv.style.animationDelay = `${index * 0.1}s`;
                
                let inputHTML = '';
                if (q.type === 'text') {
                    inputHTML = `
                        <input type="text" class="form-input" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''}>
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'textarea') {
                    inputHTML = `
                        <textarea class="form-textarea" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''}></textarea>
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'tags') {
                    inputHTML = `
                        <div class="tag-container">
                            ${q.options.map(option => `<button class="tag" onclick="toggleTag(this, '${q.id}', '${option}')">${option}</button>`).join('')}
                        </div>
                        <div class="additional-input">
                            <input type="text" placeholder="ê¸°íƒ€ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„)" id="${q.id}_additional">
                        </div>
                    `;
                }
                
                questionDiv.innerHTML = `
                    <label class="form-label">
                        ${q.question}
                        ${q.required ? '<span style="color: #f44336;">*</span>' : ''}
                    </label>
                    ${q.notice ? `<div class="question-notice">${q.notice}</div>` : ''}
                    ${inputHTML}
                `;
                
                container.appendChild(questionDiv);
            });
            
            addValidationListeners();
        }

        function loadSeparatedFamilyQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            // ì•ˆë‚´ë¬¸ ì¶”ê°€
            const noticeDiv = document.createElement('div');
            noticeDiv.className = 'question-notice';
            noticeDiv.style.marginBottom = '25px';
            noticeDiv.style.padding = '20px';
            noticeDiv.style.fontSize = '1rem';
            noticeDiv.style.fontWeight = '600';
            noticeDiv.innerHTML = 'ì•ˆë‚´ë¬¸: ì´ê³³ì€ í•œêµ­ì „ìŸ ë•Œ ì›”ë‚¨í•œ ë‹¹ì‹ ì´ ê¸°ì–µ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.';
            container.appendChild(noticeDiv);
            
            separatedFamilyQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'form-group fade-in';
                questionDiv.style.animationDelay = `${index * 0.1}s`;
                
                let inputHTML = '';
                if (q.type === 'text') {
                    inputHTML = `
                        <input type="text" class="form-input" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''}>
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'textarea') {
                    inputHTML = `
                        <textarea class="form-textarea" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''}></textarea>
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'tags') {
                    inputHTML = `
                        <div class="tag-container">
                            ${q.options.map(option => `<button class="tag" onclick="toggleTag(this, '${q.id}', '${option}')">${option}</button>`).join('')}
                        </div>
                        <div class="additional-input">
                            <input type="text" placeholder="ê¸°íƒ€ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„)" id="${q.id}_additional">
                        </div>
                    `;
                }
                
                questionDiv.innerHTML = `
                    <label class="form-label">
                        ${q.question}
                        ${q.required ? '<span style="color: #f44336;">*</span>' : ''}
                    </label>
                    ${q.notice ? `<div class="question-notice">${q.notice}</div>` : ''}
                    ${inputHTML}
                `;
                
                container.appendChild(questionDiv);
            });
            
            addValidationListeners();
        }

        function loadFriendQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            friendQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = `form-group fade-in ${q.conditional ? 'conditional-question' : ''}`;
                questionDiv.style.animationDelay = `${index * 0.1}s`;
                questionDiv.id = `question_${q.id}`;
                
                let inputHTML = '';
                if (q.type === 'text') {
                    inputHTML = `
                        <input type="text" class="form-input" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''} onchange="checkConditionalQuestions()">
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'textarea') {
                    inputHTML = `
                        <textarea class="form-textarea" id="${q.id}" placeholder="${q.placeholder}" ${q.required ? 'data-required="true"' : ''}></textarea>
                        <div class="field-error">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.</div>
                    `;
                } else if (q.type === 'tags') {
                    inputHTML = `
                        <div class="tag-container">
                            ${q.options.map(option => `<button class="tag" onclick="toggleTag(this, '${q.id}', '${option}'); checkConditionalQuestions();">${option}</button>`).join('')}
                        </div>
                        <div class="additional-input">
                            <input type="text" placeholder="ê¸°íƒ€ ì…ë ¥ (ì‰¼í‘œë¡œ êµ¬ë¶„)" id="${q.id}_additional">
                        </div>
                    `;
                }
                
                questionDiv.innerHTML = `
                    <label class="form-label">
                        ${q.question}
                        ${q.required ? '<span style="color: #f44336;">*</span>' : ''}
                    </label>
                    ${q.notice ? `<div class="question-notice">${q.notice}</div>` : ''}
                    ${inputHTML}
                `;
                
                // ì¡°ê±´ë¶€ ì§ˆë¬¸ ì´ˆê¸° ìƒíƒœ ì„¤ì •
                if (q.conditional) {
                    questionDiv.style.display = 'none';
                }
                
                container.appendChild(questionDiv);
            });
            
            addValidationListeners();
            checkConditionalQuestions(); // ì´ˆê¸° ë¡œë“œ ì‹œ ì¡°ê±´ë¶€ ì§ˆë¬¸ ì²´í¬
        }

        // ì¡°ê±´ë¶€ ì§ˆë¬¸ í‘œì‹œ/ìˆ¨ê¹€ ì²˜ë¦¬
        function checkConditionalQuestions() {
            friendQuestions.forEach(q => {
                if (q.conditional) {
                    const questionElement = document.getElementById(`question_${q.id}`);
                    const dependsOnValue = getAnswerValue(q.dependsOn);
                    
                    let shouldShow = false;
                    
                    if (q.dependsOn === 'friendType' && Array.isArray(q.showWhen)) {
                        // friendTypeì˜ ê²½ìš° ë°°ì—´ë¡œ ë‹µë³€ì´ ì €ì¥ë¨
                        shouldShow = q.showWhen.some(condition => 
                            Array.isArray(dependsOnValue) ? dependsOnValue.includes(condition) : dependsOnValue === condition
                        );
                    } else if (q.dependsOn === 'school' && q.showWhen === 'ê°™ì€ í•™êµ') {
                        // school í•„ë“œì— 'ê°™ì€ í•™êµ'ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                        shouldShow = dependsOnValue && dependsOnValue.includes('ê°™ì€ í•™êµ');
                    } else if (q.dependsOn === 'schoolTrip') {
                        // schoolTripì— ê°’ì´ ìˆìœ¼ë©´ ìˆ˜í•™ì—¬í–‰ ì¶”ì–µ ì§ˆë¬¸ í‘œì‹œ
                        shouldShow = dependsOnValue && dependsOnValue.trim() !== '';
                    }
                    
                    if (shouldShow) {
                        questionElement.style.display = 'block';
                        questionElement.classList.add('show');
                    } else {
                        questionElement.style.display = 'none';
                        questionElement.classList.remove('show');
                        // ìˆ¨ê²¨ì§„ ì§ˆë¬¸ì˜ ë‹µë³€ ì´ˆê¸°í™”
                        clearQuestionAnswer(q.id);
                    }
                }
            });
        }

        // ë‹µë³€ ê°’ ê°€ì ¸ì˜¤ê¸°
        function getAnswerValue(questionId) {
            const element = document.getElementById(questionId);
            if (!element) return null;
            
            if (element.type === 'text' || element.tagName === 'TEXTAREA') {
                return element.value.trim();
            }
            
            // tags íƒ€ì…ì˜ ê²½ìš° answers ê°ì²´ì—ì„œ ê°€ì ¸ì˜¤ê¸°
            return answers[questionId] || null;
        }

        // ì§ˆë¬¸ ë‹µë³€ ì´ˆê¸°í™”
        function clearQuestionAnswer(questionId) {
            const element = document.getElementById(questionId);
            if (element) {
                if (element.type === 'text' || element.tagName === 'TEXTAREA') {
                    element.value = '';
                }
            }
            
            // tags ì„ íƒ ì´ˆê¸°í™”
            const tags = document.querySelectorAll(`#question_${questionId} .tag.selected`);
            tags.forEach(tag => tag.classList.remove('selected'));
            
            // answers ê°ì²´ì—ì„œë„ ì œê±°
            delete answers[questionId];
        }

        function addValidationListeners() {
            document.querySelectorAll('.form-input, .form-textarea').forEach(input => {
                input.addEventListener('blur', () => validateInput(input));
                input.addEventListener('input', () => {
                    if (input.classList.contains('invalid')) {
                        validateInput(input);
                    }
                });
            });
        }

        function validateInput(input) {
            const value = input.value.trim();
            const isRequired = input.hasAttribute('data-required');
            const fieldError = input.nextElementSibling;
            
            if (isRequired && !value) {
                input.classList.add('invalid');
                input.classList.remove('valid');
                if (fieldError && fieldError.classList.contains('field-error')) {
                    fieldError.textContent = 'í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.';
                    fieldError.classList.add('show');
                }
                return false;
            } else if (value) {
                input.classList.add('valid');
                input.classList.remove('invalid');
                if (fieldError && fieldError.classList.contains('field-error')) {
                    fieldError.classList.remove('show');
                }
                return true;
            } else {
                input.classList.remove('invalid', 'valid');
                if (fieldError && fieldError.classList.contains('field-error')) {
                    fieldError.classList.remove('show');
                }
                return true;
            }
        }

        function toggleTag(element, questionId, value) {
            element.classList.toggle('selected');
            
            if (!answers[questionId]) {
                answers[questionId] = [];
            }
            
            const index = answers[questionId].indexOf(value);
            if (index > -1) {
                answers[questionId].splice(index, 1);
            } else {
                answers[questionId].push(value);
            }
            
            element.style.transform = 'scale(0.95)';
            setTimeout(() => {
                element.style.transform = '';
            }, 150);
        }

        function collectAllAnswers() {
            document.querySelectorAll('.form-input, .form-textarea').forEach(input => {
                if (input.value.trim()) {
                    answers[input.id] = input.value.trim();
                }
            });

            document.querySelectorAll('[id$="_additional"]').forEach(input => {
                if (input.value.trim()) {
                    const questionId = input.id.replace('_additional', '');
                    if (!answers[questionId]) {
                        answers[questionId] = [];
                    }
                    const additionalValues = input.value.split(',').map(v => v.trim()).filter(v => v);
                    answers[questionId] = [...(answers[questionId] || []), ...additionalValues];
                }
            });
        }

        function checkFormValidity() {
            const inputs = document.querySelectorAll('.form-input[data-required], .form-textarea[data-required]');
            let isValid = true;
            
            inputs.forEach(input => {
                // ìˆ¨ê²¨ì§„ ì§ˆë¬¸ì€ ê²€ì¦í•˜ì§€ ì•ŠìŒ
                const questionDiv = input.closest('.form-group');
                if (questionDiv && questionDiv.style.display === 'none') {
                    return;
                }
                
                if (!validateInput(input)) {
                    isValid = false;
                }
            });
            
            return isValid;
        }

        function reviewAnswers() {
            collectAllAnswers();
            
            if (!checkFormValidity()) {
                showNotification('í•„ìˆ˜ ì…ë ¥ í•­ëª©ì„ ëª¨ë‘ ì‘ì„±í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            document.getElementById('questionSection').classList.remove('active');
            document.getElementById('reviewSection').classList.add('active');
            
            updateStepNavigation(3);
            
            const reviewContent = document.getElementById('reviewContent');
            let questions;
            
            if (selectedCategory === 'missing') {
                questions = missingChildQuestions;
            } else if (selectedCategory === 'separated') {
                questions = separatedFamilyQuestions;
            } else {
                questions = friendQuestions;
            }
            
            let reviewHTML = '';
            
            questions.forEach((q, index) => {
                const answer = answers[q.id];
                
                // ì¡°ê±´ë¶€ ì§ˆë¬¸ì´ê³  ë‹µë³€ì´ ì—†ìœ¼ë©´ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                if (q.conditional && (!answer || answer === '')) {
                    return;
                }
                
                let displayAnswer = 'ì…ë ¥ë˜ì§€ ì•ŠìŒ';
                
                if (answer) {
                    if (Array.isArray(answer)) {
                        displayAnswer = answer.join(', ');
                    } else {
                        displayAnswer = answer;
                    }
                }
                
                reviewHTML += `
                    <div class="review-item fade-in" style="animation-delay: ${index * 0.1}s">
                        <div class="review-question">${q.question}</div>
                        <div class="review-answer" id="review_${q.id}">${displayAnswer}</div>
                        <button class="edit-btn" onclick="editAnswer('${q.id}', '${q.question}', '${q.type}')">ìˆ˜ì •</button>
                    </div>
                `;
            });
            
            reviewContent.innerHTML = reviewHTML;
            showNotification('ì…ë ¥ ë‚´ìš©ì„ í™•ì¸í•´ì£¼ì„¸ìš”!', 'success');
        }

        function editAnswer(questionId, questionText, questionType) {
            const currentAnswer = answers[questionId];
            let newAnswer;
            
            if (questionType === 'textarea') {
                newAnswer = prompt(`${questionText}\n\ní˜„ì¬ ë‹µë³€: ${currentAnswer || 'ì—†ìŒ'}`, currentAnswer || '');
            } else {
                newAnswer = prompt(`${questionText}\n\ní˜„ì¬ ë‹µë³€: ${currentAnswer || 'ì—†ìŒ'}\nì—¬ëŸ¬ ê°œì¸ ê²½ìš° ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•´ì£¼ì„¸ìš”.`, 
                    Array.isArray(currentAnswer) ? currentAnswer.join(', ') : (currentAnswer || ''));
            }
            
            if (newAnswer !== null) {
                if (questionType === 'tags' && newAnswer.includes(',')) {
                    answers[questionId] = newAnswer.split(',').map(item => item.trim()).filter(item => item);
                } else {
                    answers[questionId] = newAnswer.trim();
                }
                
                const reviewElement = document.getElementById(`review_${questionId}`);
                if (reviewElement) {
                    const displayAnswer = Array.isArray(answers[questionId]) ? 
                        answers[questionId].join(', ') : 
                        (answers[questionId] || 'ì…ë ¥ë˜ì§€ ì•ŠìŒ');
                    reviewElement.textContent = displayAnswer;
                    
                    reviewElement.style.background = '#e8f5e8';
                    setTimeout(() => {
                        reviewElement.style.background = '';
                    }, 1000);
                }
                
                showNotification('ë‹µë³€ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }
        }

        function goBackToQuestions() {
            document.getElementById('reviewSection').classList.remove('active');
            document.getElementById('questionSection').classList.add('active');
            updateStepNavigation(2);
        }

        function startMatching() {
            collectAllAnswers();
            
            if (!checkFormValidity()) {
                showNotification('í•„ìˆ˜ ì…ë ¥ í•­ëª©ì„ ëª¨ë‘ ì‘ì„±í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            console.log('ìˆ˜ì§‘ëœ ë‹µë³€:', answers);
            proceedToMatching();
        }

        function proceedToMatching() {
            document.getElementById('reviewSection').classList.remove('active');
            
            const btn = document.getElementById('startMatchingBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span style="display: inline-block; width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 1s linear infinite;"></span> ë§¤ì¹­ ì¤‘...';
            btn.disabled = true;
            
            showLoading('ë‹µë³€ì„ ì €ì¥í•˜ê³  ë§¤ì¹­ì„ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'ìµœì ì˜ ë§¤ì¹­ì„ ì°¾ëŠ” ì¤‘ì…ë‹ˆë‹¤');
            
            // ë°ëª¨ìš© ë§¤ì¹­ í”„ë¡œì„¸ìŠ¤
            let progress = 60;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 95) progress = 95;
                updateProgress(progress);
            }, 300);
            
            setTimeout(() => {
                clearInterval(progressInterval);
                updateProgress(100);
                hideLoading();
                showMatchingResults();
                btn.innerHTML = originalText;
                btn.disabled = false;
                updateStepNavigation(4);
                showNotification('ë§¤ì¹­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }, 2000);
        }

        function showMatchingResults() {
            document.getElementById('questionSection').classList.remove('active');
            document.getElementById('matchingResults').classList.add('active');
            
            const matchList = document.getElementById('matchList');
            
            if (selectedCategory === 'missing') {
                matchList.innerHTML = `
                    <div class="match-item fade-in" onclick="showComparison('ê¹€â—‹â—‹', 1)" style="animation-delay: 0.1s">
                        <div class="match-info">
                            <div class="match-name">ê¹€â—‹â—‹</div>
                            <div class="match-details">ë¹„ìŠ·í•œ ì‹œê¸°, ë¹„ìŠ·í•œ ì§€ì—­ â€¢ ì§‘ êµ¬ì¡° ì¼ì¹˜</div>
                        </div>
                        <div class="match-percentage">87%</div>
                    </div>
                    <div class="match-item fade-in" onclick="showComparison('ì´â—‹â—‹', 2)" style="animation-delay: 0.2s">
                        <div class="match-info">
                            <div class="match-name">ì´â—‹â—‹</div>
                            <div class="match-details">ë§ˆë‹¹ íŠ¹ì§• ì¼ì¹˜ â€¢ ê·¼ì²˜ ì¥ì†Œ ìœ ì‚¬</div>
                        </div>
                        <div class="match-percentage">73%</div>
                    </div>
                `;
            } else if (selectedCategory === 'separated') {
                matchList.innerHTML = `
                    <div class="match-item fade-in" onclick="showComparison('ë°•â—‹â—‹', 1)" style="animation-delay: 0.1s">
                        <div class="match-info">
                            <div class="match-name">ë°•â—‹â—‹</div>
                            <div class="match-details">ê°™ì€ ë³¸ê´€, ê°™ì€ ê³ í–¥ â€¢ í—¤ì–´ì§„ ì‹œê¸° ì¼ì¹˜</div>
                        </div>
                        <div class="match-percentage">94%</div>
                    </div>
                    <div class="match-item fade-in" onclick="showComparison('ìµœâ—‹â—‹', 2)" style="animation-delay: 0.2s">
                        <div class="match-info">
                            <div class="match-name">ìµœâ—‹â—‹</div>
                            <div class="match-details">ë¶í•œ ì§€ì—­ ì¼ì¹˜ â€¢ ë‚¨í•œ ì •ì°©ì§€ ê·¼ì ‘</div>
                        </div>
                        <div class="match-percentage">82%</div>
                    </div>
                `;
            } else if (selectedCategory === 'friends') {
                matchList.innerHTML = `
                    <div class="match-item fade-in" onclick="showComparison('ìµœâ—‹â—‹', 1)" style="animation-delay: 0.1s">
                        <div class="match-info">
                            <div class="match-name">ìµœâ—‹â—‹</div>
                            <div class="match-details">ê°™ì€ í•™êµ, ê°™ì€ ì‹œê¸° â€¢ ë™ë„¤ ê·¼ì ‘</div>
                        </div>
                        <div class="match-percentage">91%</div>
                    </div>
                    <div class="match-item fade-in" onclick="showComparison('ì •â—‹â—‹', 2)" style="animation-delay: 0.2s">
                        <div class="match-info">
                            <div class="match-name">ì •â—‹â—‹</div>
                            <div class="match-details">ë¹„ìŠ·í•œ ë³„ëª… â€¢ ì¹œêµ¬ íŠ¹ì§• ì¼ì¹˜</div>
                        </div>
                        <div class="match-percentage">78%</div>
                    </div>
                `;
            }
        }

        function showComparison(partnerName, partnerId) {
            currentPartner = { name: partnerName, id: partnerId };
            
            document.getElementById('matchingResults').classList.remove('active');
            document.getElementById('comparisonSection').classList.add('active');
            
            const content = document.getElementById('comparisonContent');
            let comparisonHTML = '';
            
            // ìƒ˜í”Œ ë¹„êµ ë°ì´í„°
            let currentSample, partnerSample, questions;
            
            if (selectedCategory === 'missing') {
                currentSample = sampleAnswers.missing;
                partnerSample = { ...sampleAnswers.missing, doorColor: ['ì´ˆë¡ìƒ‰'], houseType: ['ì–‘ì˜¥'] };
                questions = missingChildQuestions;
            } else if (selectedCategory === 'separated') {
                currentSample = sampleAnswers.separated;
                partnerSample = { ...sampleAnswers.separated, familyClan: 'ì „ì£¼ì´ì”¨', hometown: 'í•¨ê²½ë‚¨ë„ í¥ë‚¨ì‹œ' };
                questions = separatedFamilyQuestions;
            } else {
                currentSample = sampleAnswers.friends;
                partnerSample = { ...sampleAnswers.friends, friendType: ['ê³ ë“±í•™êµ'], gender: ['ë™ì„±'] };
                questions = friendQuestions;
            }
            
            // ì£¼ìš” ì§ˆë¬¸ë“¤ë§Œ ë¹„êµ í‘œì‹œ (ì²˜ìŒ 10ê°œ)
            questions.slice(0, 10).forEach((q, index) => {
                const myAnswer = answers[q.id] || currentSample[q.id] || 'ì •ë³´ ì—†ìŒ';
                const partnerAnswer = partnerSample[q.id] || 'ì •ë³´ ì—†ìŒ';
                
                const myAnswerStr = Array.isArray(myAnswer) ? myAnswer.join(', ') : myAnswer;
                const partnerAnswerStr = Array.isArray(partnerAnswer) ? partnerAnswer.join(', ') : partnerAnswer;
                
                // ê°„ë‹¨í•œ ë§¤ì¹­ ë¡œì§
                let matchClass = '';
                let matchIndicator = '';
                
                if (myAnswerStr === partnerAnswerStr) {
                    matchClass = 'exact-match';
                    matchIndicator = '<span class="match-indicator exact-indicator">ì •í™• ì¼ì¹˜</span>';
                } else if (myAnswerStr !== 'ì •ë³´ ì—†ìŒ' && partnerAnswerStr !== 'ì •ë³´ ì—†ìŒ') {
                    matchClass = 'similar-match';
                    matchIndicator = '<span class="match-indicator similar-indicator">ìœ ì‚¬ ì¼ì¹˜</span>';
                }
                
                comparisonHTML += `
                    <div class="comparison-item ${matchClass} fade-in" style="animation-delay: ${index * 0.1}s">
                        <div class="question-title">${q.question} ${matchIndicator}</div>
                        <div class="answer-comparison">
                            <div class="my-answer-section">
                                <div class="answer-label my-answer-label">ë‚˜ì˜ ë‹µë³€</div>
                                <div class="answer-content my-answer">${myAnswerStr}</div>
                            </div>
                            <div class="partner-answer-section">
                                <div class="answer-label partner-answer-label">${currentPartner.name}ë‹˜ì˜ ë‹µë³€</div>
                                <div class="answer-content partner-answer">${partnerAnswerStr}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = comparisonHTML;
            showNotification('ìƒì„¸ ë¹„êµ ì •ë³´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!', 'success');
        }

        function goBackToMatching() {
            document.getElementById('comparisonSection').classList.remove('active');
            document.getElementById('matchingResults').classList.add('active');
        }

        function proceedToChat() {
            document.getElementById('comparisonSection').classList.remove('active');
            document.getElementById('chatRoom').classList.add('active');
            document.getElementById('chatPartnerName').textContent = `${currentPartner.name}ë‹˜ê³¼ì˜ ëŒ€í™”`;
            
            updateStepNavigation(5);
            
            // ë°ëª¨ ì±„íŒ… ì‹œì‘
            startDemoChat();
            
            showNotification('ì‹¤ì‹œê°„ ì±„íŒ…ë°©ì— ì…ì¥í–ˆìŠµë‹ˆë‹¤!', 'success');
        }

        function startDemoChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            setTimeout(() => {
                displayMessage('ì•ˆë…•í•˜ì„¸ìš”! ë§¤ì¹­ë˜ì–´ì„œ ì—°ë½ë“œë¦½ë‹ˆë‹¤. í˜¹ì‹œ ì €ë¥¼ ê¸°ì–µí•˜ì‹œë‚˜ìš”?', currentPartner.name, 'received');
            }, 1000);
        }

        function displayMessage(text, sender, type) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type} fade-in`;
            
            if (type === 'received') {
                messageDiv.innerHTML = `<div style="font-size: 0.8rem; color: #999; margin-bottom: 3px;">${sender}</div>${text}`;
            } else {
                messageDiv.textContent = text;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                showNotification('ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            displayMessage(message, currentUser.nickname, 'sent');
            input.value = '';
            
            // ë°ëª¨ ìë™ ì‘ë‹µ
            setTimeout(() => {
                const responses = [
                    "ë„¤, ë§ìŠµë‹ˆë‹¤! ì •ë§ ë°˜ê°€ì›Œìš”! ğŸ˜Š",
                    "ê·¸ë•Œ ì •ë§ ì¬ë¯¸ìˆì—ˆëŠ”ë°... ê¸°ì–µë‚˜ì‹œë‚˜ìš”?",
                    "ì™€, ì´ë ‡ê²Œ ë‹¤ì‹œ ë§Œë‚˜ë‹¤ë‹ˆ! ì •ë§ ì‹ ê¸°í•´ìš”!",
                    "ì •ë§ ì˜¤ëœë§Œì´ì—ìš”! ì–´ë–»ê²Œ ì§€ë‚´ì…¨ì–´ìš”?",
                    "ì´ë ‡ê²Œ ì°¾ì•„ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•´ìš”! ğŸ™"
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                displayMessage(randomResponse, currentPartner.name, 'received');
            }, 1000 + Math.random() * 2000);
        }

        function goBackToCategory() {
            // í˜„ì¬ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('questionSection').classList.remove('active');
            document.getElementById('questionSection').classList.add('hidden');
            document.getElementById('reviewSection').classList.remove('active');
            document.getElementById('matchingResults').classList.remove('active');
            document.getElementById('comparisonSection').classList.remove('active');
            document.getElementById('chatRoom').classList.remove('active');
            
            // ì¹´í…Œê³ ë¦¬ ë°” ìˆ¨ê¸°ê¸°
            document.getElementById('currentCategoryBar').style.display = 'none';
            
            // ì¹´í…Œê³ ë¦¬ ì„ íƒìœ¼ë¡œ ëŒì•„ê°€ê¸°
            document.getElementById('mainCategorySection').classList.remove('hidden');
            
            // ìŠ¤í…ê³¼ ì§„í–‰ë¥  ì´ˆê¸°í™”
            updateStepNavigation(1);
            updateProgress(20);
            
            // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
            selectedCategory = '';
            selectedSubCategory = '';
            answers = {};
            
            // ì¹´í…Œê³ ë¦¬ ì„ íƒ í•´ì œ
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // ë°°ë„ˆ ìˆ¨ê¸°ê¸°
            document.getElementById('consultationBanner').style.display = 'none';
            
            showNotification('ì¹´í…Œê³ ë¦¬ ì„ íƒìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤', 'success');
        }

        function initBackgroundAnimation() {
            const bgAnimation = document.getElementById('bgAnimation');
            const memories = ['ğŸ’­', 'â¤ï¸', 'ğŸŒŸ', 'ğŸ“š', 'ğŸµ', 'âš½', 'ğŸ®', 'âœ¨', 'ğŸŒˆ', 'ğŸ’«', 'ğŸ¯', 'ğŸ”', 'ğŸ’¡', 'ğŸ ', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 'ğŸª'];
            
            setInterval(() => {
                const memory = document.createElement('div');
                memory.className = 'floating-memory';
                memory.textContent = memories[Math.floor(Math.random() * memories.length)];
                memory.style.left = Math.random() * 100 + '%';
                memory.style.animationDelay = Math.random() * 2 + 's';
                memory.style.animationDuration = (15 + Math.random() * 10) + 's';
                
                bgAnimation.appendChild(memory);
                
                setTimeout(() => {
                    if (memory.parentNode) {
                        memory.parentNode.removeChild(memory);
                    }
                }, 25000);
            }, 3000);
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                const currentSection = document.querySelector('.question-section.active, .review-section.active');
                if (currentSection) {
                    if (currentSection.id === 'questionSection') {
                        reviewAnswers();
                    } else if (currentSection.id === 'reviewSection') {
                        proceedToMatching();
                    }
                }
            }
        });

        // ì•± ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            initBackgroundAnimation();
            initFirebase();
            initKakao();
            initSocket();
            
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.5s ease';
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
